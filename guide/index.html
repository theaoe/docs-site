<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1、ES6 简介 | theaoe</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/docs-site/logo.png">
    <link rel="stylesheet" href="/docs-site/css/style.css">
    <meta name="description" content="Weclome my friend">
    
    <link rel="preload" href="/docs-site/assets/css/0.styles.b9040e75.css" as="style"><link rel="preload" href="/docs-site/assets/js/app.9e22c575.js" as="script"><link rel="preload" href="/docs-site/assets/js/2.ad40f37e.js" as="script"><link rel="preload" href="/docs-site/assets/js/9.408ed747.js" as="script"><link rel="prefetch" href="/docs-site/assets/js/10.eddfd84a.js"><link rel="prefetch" href="/docs-site/assets/js/11.fcd98c99.js"><link rel="prefetch" href="/docs-site/assets/js/12.a45f2495.js"><link rel="prefetch" href="/docs-site/assets/js/13.c060eb24.js"><link rel="prefetch" href="/docs-site/assets/js/14.8e1fa456.js"><link rel="prefetch" href="/docs-site/assets/js/15.c93891cc.js"><link rel="prefetch" href="/docs-site/assets/js/16.ae578209.js"><link rel="prefetch" href="/docs-site/assets/js/17.14918a37.js"><link rel="prefetch" href="/docs-site/assets/js/3.8151d962.js"><link rel="prefetch" href="/docs-site/assets/js/4.4dd49430.js"><link rel="prefetch" href="/docs-site/assets/js/5.f57b557f.js"><link rel="prefetch" href="/docs-site/assets/js/6.2234959b.js"><link rel="prefetch" href="/docs-site/assets/js/7.a5c61512.js"><link rel="prefetch" href="/docs-site/assets/js/8.a1159853.js">
    <link rel="stylesheet" href="/docs-site/assets/css/0.styles.b9040e75.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs-site/" class="home-link router-link-active"><img src="/docs-site/logo.jpg" alt="theaoe" class="logo"> <span class="site-name can-hide">theaoe</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs-site/guide/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ES6入门
</a></div><div class="nav-item"><a href="/docs-site/engineering/" class="nav-link">
  前端工程化
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs-site/guide/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ES6入门
</a></div><div class="nav-item"><a href="/docs-site/engineering/" class="nav-link">
  前端工程化
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ECMAScript6 入门</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs-site/guide/" aria-current="page" class="active sidebar-link">1、ES6 简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-1、ecmascript-和-javascript-的关系" class="sidebar-link">1.1、ECMAScript 和 JavaScript 的关系</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-2、ecmascript-历史版本" class="sidebar-link">1.2、ECMAScript 历史版本</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-3、语法提案的批准流程" class="sidebar-link">1.3、语法提案的批准流程</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-4、部署进度" class="sidebar-link">1.4、部署进度</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5、babel转码器" class="sidebar-link">1.5、Babel转码器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-1、配置文件-babelrc" class="sidebar-link">1.5.1、配置文件.babelrc</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-2、命令行转码babel-cli" class="sidebar-link">1.5.2、命令行转码babel-cli</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-3、babel-node" class="sidebar-link">1.5.3、babel-node</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-4、babel-register" class="sidebar-link">1.5.4、babel-register</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-5、babel-core" class="sidebar-link">1.5.5、babel-core</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-6、babel-polyfill" class="sidebar-link">1.5.6、babel-polyfill</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-7、浏览器环境" class="sidebar-link">1.5.7、浏览器环境</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-8、在线转换" class="sidebar-link">1.5.8、在线转换</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-5-9、与其他工具的配合" class="sidebar-link">1.5.9、与其他工具的配合</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-6、traceur转码器" class="sidebar-link">1.6、Traceur转码器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-6-1、直接插入网页" class="sidebar-link">1.6.1、直接插入网页</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-6-2、在线转换" class="sidebar-link">1.6.2、在线转换</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-6-3、命令行转换" class="sidebar-link">1.6.3、命令行转换</a></li><li class="sidebar-sub-header"><a href="/docs-site/guide/#_1-6-4、node-环境的用法" class="sidebar-link">1.6.4、Node 环境的用法</a></li></ul></li></ul></li><li><a href="/docs-site/guide/ecma/command.html" class="sidebar-link">2、Let &amp; const 命令</a></li><li><a href="/docs-site/guide/ecma/assignment.html" class="sidebar-link">3、变量的解构赋值</a></li><li><a href="/docs-site/guide/ecma/string.html" class="sidebar-link">4、字符串的扩展</a></li><li><a href="/docs-site/guide/ecma/regular.html" class="sidebar-link">5、正则的扩展</a></li><li><a href="/docs-site/guide/ecma/numerical.html" class="sidebar-link">6、数值的扩展</a></li><li><a href="/docs-site/guide/ecma/function.html" class="sidebar-link">7、函数的扩展</a></li><li><a href="/docs-site/guide/ecma/array.html" class="sidebar-link">8、数组的扩展</a></li><li><a href="/docs-site/guide/ecma/object.html" class="sidebar-link">9、对象的扩展</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1、es6-简介"><a href="#_1、es6-简介" class="header-anchor">#</a> 1、ES6 简介</h1> <p>ECMAScript 6.0（以下简称 ES6）是 JavaScript 语言的下一代标准，已经在 2015 年 6 月正式发布了。它的目标，是使得 JavaScript 语言可以用来编写复杂的大型应用程序，成为企业级开发语言。</p> <h2 id="_1-1、ecmascript-和-javascript-的关系"><a href="#_1-1、ecmascript-和-javascript-的关系" class="header-anchor">#</a> 1.1、ECMAScript 和 JavaScript 的关系</h2> <ul><li><p>ECMA 是 European Computer Manufacturers Association 的缩写，即欧洲计算机制造商协会。欧洲计算机制造商协会是制定信息传输与通讯的国际化标准组织。</p></li> <li><p>1996 年 11 月，JavaScript 的创造者 Netscape 公司，决定将 JavaScript 提交给 ECMA，希望这种语言能够成为国际标准。次年，ECMA 发布 262 号标准文件（ECMA-262）的第一版，规定了浏览器脚本语言的标准，并将这种语言称为 ECMAScript，这个版本就是 1.0 版。</p></li> <li><p>该标准从一开始就是针对 JavaScript 语言制定的，但之所以不叫 Java Script，有两个原因。一是商标，Java 是 Sun 公司的商标，根据授权协议，只有 Netscape 公司可以合法地使用 JavaScript 这个名字，且 JavaScript 本身也已经被 Netscape 公司注册为商标。二是想体现这门语言的 制定者是 ECMA，不是 Netscape，这样有利于保证这门语言的开放性和中立性。</p></li> <li><p>因此，ECMAScript 和 JavaScript 的关系是，ECMA 是 JavaScript 的 标准， JavaScript 是 ECMA 的一种实现。</p></li></ul> <h2 id="_1-2、ecmascript-历史版本"><a href="#_1-2、ecmascript-历史版本" class="header-anchor">#</a> 1.2、ECMAScript 历史版本</h2> <table><thead><tr><th>时间</th> <th style="text-align:center;">版本</th> <th style="text-align:right;">详情</th></tr></thead> <tbody><tr><td>1996.11</td> <td style="text-align:center;">ES 1.0</td> <td style="text-align:right;">Netscape 将 JS 提 交给 ECMA 组织，ES 正式出现</td></tr> <tr><td>1998.06</td> <td style="text-align:center;">ES 2.0</td> <td style="text-align:right;">ES2 正 式发布</td></tr> <tr><td>1999.12</td> <td style="text-align:center;">ES 3.0</td> <td style="text-align:right;">ES3 被广泛支持</td></tr> <tr><td>2007.10</td> <td style="text-align:center;">ES 4.0</td> <td style="text-align:right;">ES4 过于激进被废弃</td></tr> <tr><td>2008.07</td> <td style="text-align:center;">ES 3.1</td> <td style="text-align:right;">4.0 退化为严重 缩水版的 3.1， ES 3.1 代号为 Harmony（和谐）</td></tr> <tr><td>2009.12</td> <td style="text-align:center;">ES 5.0</td> <td style="text-align:right;">ES 5.0 正式发布，同时公布了 JavaScript .next 也就是后来的 ES 6.0</td></tr> <tr><td>2011.06</td> <td style="text-align:center;">ES 5.1</td> <td style="text-align:right;">ES 5.1 成为 ISO 国际标准</td></tr> <tr><td>2013.03</td> <td style="text-align:center;">ES 6.0</td> <td style="text-align:right;">ES    6.0 草案定稿</td></tr> <tr><td>2013.12</td> <td style="text-align:center;">ES 6.0</td> <td style="text-align:right;">ES 6.0 草案发布</td></tr> <tr><td>2015.06</td> <td style="text-align:center;">ES 6.0</td> <td style="text-align:right;">ES 6.0 预计发布正式版，JavaScript 开始指向 ES 7.0</td></tr></tbody></table> <p>因此，ES6 既是一个历史名词，也是一个泛指，含义是 5.1 版以后的 JavaScript 的下一代标准，涵盖了<br> ES2015、ES2016、ES2017 等等，而 ES2015 则是正式名称，特指该年发布的正式版本的语言标准。<br>本书中提到 ES6 的地方，一般是指 ES2015 标准，但有时也是泛指“下一代 JavaScript 语言”。</p> <h2 id="_1-3、语法提案的批准流程"><a href="#_1-3、语法提案的批准流程" class="header-anchor">#</a> 1.3、语法提案的批准流程</h2> <p>任何人都可以向标准委员会（又称 TC39 委员会）提案，要求修改语言标准。<br>
一种新的语法从提案到变成正式标准，需要经历五个阶段。每个阶段的变动都需要由 TC39 委员会批准。<br></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Stage 0 - Strawman（展示阶段）</li> <li>Stage 1 - Proposal（征求意见阶段）</li> <li>Stage 2 - Draft（草案阶段）</li> <li>Stage 3 - Candidate（候选人阶段）</li> <li>Stage 4 - Finished（定案阶段）</li></ul></div> <p>一个提案只要能进入Stage 2，就差不多等于肯定会包括在以后的正式标准里面。<br>ECMAScript当前的所有提案，可以在TC39的官方网站Github.com/tc39/ecma262查看。</p> <h2 id="_1-4、部署进度"><a href="#_1-4、部署进度" class="header-anchor">#</a> 1.4、部署进度</h2> <p>各大浏览器的最新版本，对ES6的支持可以查看  <a href="https://kangax.github.io/es5-compat-table/es6/" target="_blank" rel="noopener noreferrer">ES6支持<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。随着时间的推移，支持度己经越来越高，超过 90% ES6 语法特性都实现了。</p> <p>Node.js是JavaScript语言的服务器运行环境，对ES6的支持度比浏览器更高。通过Node，可以体验更多ES6的特性。建议使用版本管理工具 <a href="https://github.com/creationix/nvm" target="_blank" rel="noopener noreferrer">nvm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，来安装Node，因为可以自由切换版本。不过，nvm不支持Windows系统，如果你使用Windows系统，下面的操作可以改用 <a href="https://github.com/hakobera/nvmw" target="_blank" rel="noopener noreferrer">nvmw<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>或 <a href="https://github.com/coreybutler/nvm-windows" target="_blank" rel="noopener noreferrer">nvmw-windows<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>代替。</p> <ol><li>安装nvm需要打开命令行窗口，运行下面的命令。</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> -o- https://raw.githubusercontent.com/creationix/nvm/<span class="token operator">&lt;</span>version number<span class="token operator">&gt;</span>/install.sh <span class="token operator">|</span> <span class="token function">bash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>上面命令的version number处，需要用版本号替换。本节写作时的版本号是v0.29.0。该命令运行后，nvm会默认安装在用户主目录的.nvm子目录。</p></div> <ol start="2"><li>然后，激活nvm。</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">source</span> ~/.nvm/nvm.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="3"><li>激活以后，安装Node的最新版。</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ nvm <span class="token function">install</span> node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="4"><li>安装完成后，切换到该版本。</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ nvm use node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="5"><li>使用下面的命令，可以查看Node所有已经实现的ES6特性。</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ node --v8-options <span class="token operator">|</span> <span class="token function">grep</span> harmony
  -- harmony_typeof
  -- harmony_scoping
  --harmony_modules
  --harmony_symbols
  --harmony_proxies
  --harmony_collections
  --harmony_observation
  --harmony_generators
  --harmony_iteration
  --harmony_numeric_literals
  --harmony_strings
  --harmony_arrays
  --harmony_maths
  --harmony
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>上面命令的输出结果，会因为版本的不同而有所不同。</p> <p>阮一峰写了一个 <a href="https://github.com/ruanyf/es-checker" target="_blank" rel="noopener noreferrer">ES-Checker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>模块，用来检查各种运行环境对ES6的支持情况。访问 <a href="https://github.com/ruanyf/es-checker" target="_blank" rel="noopener noreferrer">ES-Checker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
可以看到您的浏览器支持ES6的程度。运行下面的命令，可以查看你正在使用的Node环境对ES6的支持程度。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> -g es-checker
$ es-checker

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Passes <span class="token number">24</span> feature Dectations
Your runtime supports <span class="token number">57</span>% of ECMAScript <span class="token number">6</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_1-5、babel转码器"><a href="#_1-5、babel转码器" class="header-anchor">#</a> 1.5、Babel转码器</h2> <p><a href="https://babeljs.io/" target="_blank" rel="noopener noreferrer">Babel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一个广泛使用的ES6转码器，可以将ES6代码转为ES5代码，从而在现有环境执行。这意味着，你可以用ES6的方式编写程序，又不用担心现有环境是否支持。下面是一个例子。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 转码前</span>
Array<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 转码后</span>
Array<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> item <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>上面的原始代码用了箭头函数，这个特性还没有得到广泛支持，Babel将其转为普通函数，就能在现有的JavaScript环境执行了。</p> <h3 id="_1-5-1、配置文件-babelrc"><a href="#_1-5-1、配置文件-babelrc" class="header-anchor">#</a> 1.5.1、配置文件.babelrc</h3> <ul><li>Babel的配置文件是.babelrc，存放在项目的根目录下。使用Babel的第一步，就是配置这个文件。
该文件用来设置转码规则和插件，基本格式如下。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>presets字段设定转码规则，官方提供以下的规则集，你可以根据需要安装。</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># ES2015转码规则</span>
$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-preset-es2015

<span class="token comment"># react转码规则</span>
$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-preset-react

<span class="token comment"># ES7不同阶段语法提案的转码规则（共有4个阶段），选装一个</span>
$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-preset-stage-0
$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-preset-stage-1
$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-preset-stage-2
$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-preset-stage-3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>然后，将这些规则加入.babelrc。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;stage-2&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>以下所有Babel工具和模块的使用，都必须先写好.babelrc。</p></div> <h3 id="_1-5-2、命令行转码babel-cli"><a href="#_1-5-2、命令行转码babel-cli" class="header-anchor">#</a> 1.5.2、命令行转码babel-cli</h3> <p>Babel提供babel-cli工具，用于命令行转码。它的安装命令如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ npm install <span class="token operator">--</span>global babel<span class="token operator">-</span>cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>基本用法如下。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 转码结果输出到标准输出</span>
$ babel example<span class="token punctuation">.</span>js

<span class="token comment">// 转码结果写入一个文件</span>
<span class="token comment">// --out-file 或 -o 参数指定输出文件</span>
$ babel example<span class="token punctuation">.</span>js <span class="token operator">--</span>out<span class="token operator">-</span>file compiled<span class="token punctuation">.</span>js
<span class="token comment">// 或者</span>
$ babel example<span class="token punctuation">.</span>js <span class="token operator">-</span>o compiled<span class="token punctuation">.</span>js

<span class="token comment">// 整个目录转码</span>
<span class="token comment">// --out-dir 或 -d 参数指定输出目录</span>
$ babel src <span class="token operator">--</span>out<span class="token operator">-</span>dir lib
<span class="token comment">// 或者</span>
$ babel src <span class="token operator">-</span>d lib

<span class="token comment">// -s 参数生成source map文件</span>
$ babel src <span class="token operator">-</span>d lib <span class="token operator">-</span>s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>上面代码是在全局环境下，进行Babel转码。这意味着，如果项目要运行，全局环境必须有Babel，也就是说项目产生了对环境的依赖。另一方面，这样做也无法支持不同项目使用不同版本的Babel。</p> <p>一个解决办法是将babel-cli安装在项目之中。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 安装</span>
$ npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev babel<span class="token operator">-</span>cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后，改写package.json。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token string">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;babel-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.0.0&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel src -d lib&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>转码的时候，就执行下面的命令。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ npm run build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_1-5-3、babel-node"><a href="#_1-5-3、babel-node" class="header-anchor">#</a> 1.5.3、babel-node</h3> <ul><li>babel-cli工具自带一个babel-node命令，提供一个支持ES6的REPL环境。它支持Node的REPL环境的所有功能，而且可以直接运行ES6代码。</li> <li>它不用单独安装，而是随babel-cli一起安装。然后，执行babel-node就进入REPL环境。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ babel<span class="token operator">-</span>node
<span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>babel-node命令可以直接运行ES6脚本。将上面的代码放入脚本文件es6.js，然后直接运行。</p></div> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ babel<span class="token operator">-</span>node es6<span class="token punctuation">.</span>js
<span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>babel-node也可以安装在项目中。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;script-name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel-node script.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面代码中，使用babel-node替代node，这样script.js本身就不用做任何转码处理。</p> <h3 id="_1-5-4、babel-register"><a href="#_1-5-4、babel-register" class="header-anchor">#</a> 1.5.4、babel-register</h3> <p>babel-register模块改写require命令，为它加上一个钩子。此后，每当使用require加载.js、.jsx、.es和.es6后缀名的文件，就会先用Babel进行转码。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev babel<span class="token operator">-</span>register
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用时，必须首先加载babel-register。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 例如这样</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;babel-register&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>然后，就不需要手动对index.js转码了。</p> <div class="custom-block warning"><p class="custom-block-title">需要注意的是</p> <p>babel-register只会对require命令加载的文件转码，而不会对当前文件转码。另外，由于它是实时转码，所以只适合在开发环境使用。</p></div> <h3 id="_1-5-5、babel-core"><a href="#_1-5-5、babel-core" class="header-anchor">#</a> 1.5.5、babel-core</h3> <p>如果某些代码需要调用Babel的API进行转码，就要使用babel-core模块。</p> <ul><li>安装命令如下：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ npm install babel<span class="token operator">-</span>core <span class="token operator">--</span>save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>然后，在项目中就可以调用babel-core。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'babel-core'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 字符串转码</span>
babel<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token string">'code();'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { code, map, ast }</span>

<span class="token comment">// 文件转码（异步）</span>
babel<span class="token punctuation">.</span><span class="token function">transformFile</span><span class="token punctuation">(</span><span class="token string">'filename.js'</span><span class="token punctuation">,</span> options<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  result<span class="token punctuation">;</span> <span class="token comment">// =&gt; { code, map, ast }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 文件转码（同步）</span>
babel<span class="token punctuation">.</span><span class="token function">transformFileSync</span><span class="token punctuation">(</span><span class="token string">'filename.js'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { code, map, ast }</span>

<span class="token comment">// Babel AST转码</span>
babel<span class="token punctuation">.</span><span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> code<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { code, map, ast }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>配置对象options，可以参看官方文档 <a href="http://babeljs.io/docs/usage/options/" target="_blank" rel="noopener noreferrer">配置对象options<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>下面是一个例子:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> es6Code <span class="token operator">=</span> <span class="token string">'let x = n =&gt; n + 1'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> es5Code <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'babel-core'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>es6Code<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'es2015'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>code<span class="token punctuation">;</span>
<span class="token comment">// '&quot;use strict&quot;;\n\nvar x = function x(n) {\n  return n + 1;\n};'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>上面代码中，transform方法的第一个参数是一个字符串，表示需要被转换的ES6代码，第二个参数是转换的配置对象。</p> <h3 id="_1-5-6、babel-polyfill"><a href="#_1-5-6、babel-polyfill" class="header-anchor">#</a> 1.5.6、babel-polyfill</h3> <p>Babel默认只转换新的JavaScript句法（syntax），而不转换新的API，比如Iterator、Generator、Set、Maps、Proxy、Reflect、Symbol、Promise等全局对象，以及一些定义在全局对象上的方法（比如Object.assign）都不会转码。</p> <p>举例来说，ES6在Array对象上新增了Array.from方法。Babel就不会转码这个方法。如果想让这个方法运行，必须使用babel-polyfill，为当前环境提供一个垫片。</p> <p>安装命令如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> --save babel-polyfill
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后，在脚本头部，加入如下一行代码。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'babel-polyfill'</span><span class="token punctuation">;</span>
<span class="token comment">// 或者</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'babel-polyfill'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Babel默认不转码的API非常多，详细清单可以查看babel-plugin-transform-runtime模块的 <a href="https://github.com/babel/babel/blob/master/packages/babel-plugin-transform-runtime/src/runtime-corejs2-definitions.js" target="_blank" rel="noopener noreferrer">definitions.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>文件。</p> <h3 id="_1-5-7、浏览器环境"><a href="#_1-5-7、浏览器环境" class="header-anchor">#</a> 1.5.7、浏览器环境</h3> <p>Babel也可以用于浏览器环境。但是，从Babel 6.0开始，不再直接提供浏览器版本，而是要用构建工具构建出来。如果你没有或不想使用构建工具，可以通过安装5.x版本的babel-core模块获取。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ npm install babel<span class="token operator">-</span>core@<span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>运行上面的命令以后，就可以在当前目录的node_modules/babel-core/子目录里面，找到babel的浏览器版本
<span style="color:#7ec699;">browser.js（未精简）</span>和 <span style="color:#f08d49;">browser.min.js（已精简）</span>。</p> <p>然后，将下面的代码插入网页。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;node_modules/babel-core/browser.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/babel&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// Your ES6 code</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面代码中，<code>browser.js</code>是Babel提供的转换器脚本，可以在浏览器运行。用户的ES6脚本放在<code>script</code>标签之中，但是要注明<code>type=&quot;text/babel&quot;</code>。</p> <p>另一种方法是使用 <a href="https://github.com/Daniel15/babel-standalone" target="_blank" rel="noopener noreferrer">babel-standalone<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 模块提供的浏览器版本，将其插入网页。</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>网页中实时将ES6代码转为ES5，对性能会有影响。生产环境需要加载已经转码完成的脚本。</p></div> <p>下面是如何将代码打包成浏览器可以使用的脚本，以<code>Babel</code>配合<code>Browserify</code>为例。首先，安装<code>babelify</code>模块。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev babelify babel<span class="token operator">-</span>preset<span class="token operator">-</span>es2015
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后，再用命令行转换ES6脚本。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$  browserify script<span class="token punctuation">.</span>js <span class="token operator">-</span>o bundle<span class="token punctuation">.</span>js \
  <span class="token operator">-</span>t <span class="token punctuation">[</span> babelify <span class="token operator">--</span>presets <span class="token punctuation">[</span> es2015 <span class="token punctuation">]</span> <span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面代码将ES6脚本<code>script.js</code>，转为<code>bundle.js</code>，浏览器直接加载后者就可以了。</p> <p>在<code>package.json</code>设置下面的代码，就不用每次命令行都输入参数了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;browserify&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;transform&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;babelify&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_1-5-8、在线转换"><a href="#_1-5-8、在线转换" class="header-anchor">#</a> 1.5.8、在线转换</h3> <p>Babel提供一个 <a href="https://babeljs.io/repl/" target="_blank" rel="noopener noreferrer">REPL在线编译器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，可以在线将ES6代码转为ES5代码。转换后的代码，可以直接作为ES5代码插入网页运行。</p> <h3 id="_1-5-9、与其他工具的配合"><a href="#_1-5-9、与其他工具的配合" class="header-anchor">#</a> 1.5.9、与其他工具的配合</h3> <p>许多工具需要Babel进行前置转码，这里举两个例子：<code>ESLint</code>和<code>Mocha</code>。</p> <p>ESLint用于静态检查代码的语法和风格，安装命令如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>$ npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev eslint babel<span class="token operator">-</span>eslint
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后，在项目根目录下，新建一个配置文件<code>.eslintrc</code>，在其中加入<code>parser</code>字段。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel-eslint&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>再在<code>package.json</code>之中，加入相应的<code>scripts</code>脚本。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my-module&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint my-files.js&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;babel-eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Mocha则是一个测试框架，如果需要执行使用ES6语法的测试脚本，可以修改<code>package.json</code>的<code>scripts.test</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mocha --ui qunit --compilers js:babel-core/register&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面命令中，<code>--compilers</code>参数指定脚本的转码器，规定后缀名为<code>js</code>的文件，都需要使用<code>babel-core/register</code>先转码。</p> <h2 id="_1-6、traceur转码器"><a href="#_1-6、traceur转码器" class="header-anchor">#</a> 1.6、Traceur转码器</h2> <p>Google公司的 <a href="https://github.com/google/traceur-compiler" target="_blank" rel="noopener noreferrer">Traceur<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>转码器，也可以将ES6代码转为ES5代码。</p> <h3 id="_1-6-1、直接插入网页"><a href="#_1-6-1、直接插入网页" class="header-anchor">#</a> 1.6.1、直接插入网页</h3> <p>首先，必须在网页头部 Traceur 库文</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://google.github.io/traceur-compiler/bin/traceur.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://google.github.io/traceur-compiler/bin/BrowserSystem.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://google.github.io/traceur-compiler/src/bootstrap.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">import</span> <span class="token string">'./Greeter.js'</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上面代码中，一共有4个<code>script</code>标签。第一个是加载<code>Traceur</code>的库文件，第二个和第三个是将这个库文件用于浏览器环境，第四个则是加载用户脚本，这个脚本里面可以使用ES6代码。</p> <p>注意，第四个<code>script</code>标签的<code>type</code>属性的值是<code>module</code>，而不是<code>text/javascript</code>。这是Traceur编译器识别ES6代码的标志，编译器会自动将所有<code>type=module</code>的代码编译为ES5，然后再交给浏览器执行。</p> <p>除了引用外部ES6脚本，也可以直接在网页中放置ES6代码。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">class</span> <span class="token class-name">Calc</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Calc constructor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// 正常情况下，上面代码会在控制台打印出9。</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>如果想对Traceur的行为有精确控制，可以采用下面参数配置的写法。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  <span class="token comment">// Create the System object</span>
  window<span class="token punctuation">.</span>System <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">traceur<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>BrowserTraceurLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Set some experimental options</span>
  <span class="token keyword">var</span> metadata <span class="token operator">=</span> <span class="token punctuation">{</span>
    traceurOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
      experimental<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      properTailCalls<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      symbols<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      arrayComprehension<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      asyncFunctions<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      asyncGenerators<span class="token operator">:</span> exponentiation<span class="token punctuation">,</span>
      forOn<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      generatorComprehension<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// Load your module</span>
  System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">'./myModule.js'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>metadata<span class="token operator">:</span> metadata<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Import failed'</span><span class="token punctuation">,</span> ex<span class="token punctuation">.</span>stack <span class="token operator">||</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>上面代码中，首先生成Traceur的全局对象<code>window.System</code>，然后<code>System.import</code>方法可以用来加载ES6模块。加载的时候，需要传入一个配置对象<code>metadata</code>，该对象的<code>traceurOptions</code>属性可以配置支持ES6功能。如果设为<code>experimental: true</code>，就表示除了ES6以外，还支持一些实验性的新功能。</p> <h3 id="_1-6-2、在线转换"><a href="#_1-6-2、在线转换" class="header-anchor">#</a> 1.6.2、在线转换</h3> <p>Traceur也提供一个 <a href="http://google.github.io/traceur-compiler/demo/repl.html" target="_blank" rel="noopener noreferrer">在线编译器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，可以在线将ES6代码转为ES5代码。转换后的代码，可以直接作为ES5代码插入网页运行。</p> <p>上面的例子转为ES5代码运行，就是下面这个样子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://google.github.io/traceur-compiler/bin/traceur.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://google.github.io/traceur-compiler/bin/BrowserSystem.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://google.github.io/traceur-compiler/src/bootstrap.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
$traceurRuntime<span class="token punctuation">.</span>ModuleStore<span class="token punctuation">.</span><span class="token function">getAnonymousModule</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> <span class="token function-variable function">Calc</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Calc constructor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token punctuation">(</span>$traceurRuntime<span class="token punctuation">.</span>createClass<span class="token punctuation">)</span><span class="token punctuation">(</span>Calc<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_1-6-3、命令行转换"><a href="#_1-6-3、命令行转换" class="header-anchor">#</a> 1.6.3、命令行转换</h3> <p>作为命令行工具使用时，Traceur是一个Node的模块，首先需要用Npm安装。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> -g traceur
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>安装成功后，就可以在命令行下使用Traceur了。</p> <p>Traceur直接运行es6脚本文件，会在标准输出显示运行结果，以前面的calc.js为例。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ traceur calc.js
Calc constructor
<span class="token number">9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果要将ES6脚本转为ES5保存，要采用下面的写法。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ traceur --script calc.es6.js --out calc.es5.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面代码的<code>--script</code>选项表示指定输入文件，<code>--out</code>选项表示指定输出文件。</p> <p>为了防止有些特性编译不成功，最好加上<code>--experimental</code>选项。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ traceur --script calc.es6.js --out calc.es5.js --experimental
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>命令行下转换生成的文件，就可以直接放到浏览器中运行。</p> <h3 id="_1-6-4、node-环境的用法"><a href="#_1-6-4、node-环境的用法" class="header-anchor">#</a> 1.6.4、Node 环境的用法</h3> <p>Traceur的Node.js用法如下（假定已安装traceur模块）。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> traceur <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'traceur'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将ES6脚本转为字符串</span>
<span class="token keyword">var</span> contents <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'es6-file.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> result <span class="token operator">=</span> traceur<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>contents<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  filename<span class="token operator">:</span> <span class="token string">'es6-file.js'</span><span class="token punctuation">,</span>
  sourceMap<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 其他设置</span>
  modules<span class="token operator">:</span> <span class="token string">'commonjs'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
  <span class="token keyword">throw</span> result<span class="token punctuation">.</span>error<span class="token punctuation">;</span>

<span class="token comment">// result对象的js属性就是转换后的ES5代码</span>
fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'out.js'</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>js<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// sourceMap属性对应map文件</span>
fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'out.js.map'</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>sourceMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/2/2021, 5:33:49 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/docs-site/guide/ecma/command.html">
        2、Let &amp; const 命令
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs-site/assets/js/app.9e22c575.js" defer></script><script src="/docs-site/assets/js/2.ad40f37e.js" defer></script><script src="/docs-site/assets/js/9.408ed747.js" defer></script>
  </body>
</html>
